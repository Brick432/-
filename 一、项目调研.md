# 一、项目调研
## 1.1 目的
通过调研，明确企业开展此项工作的必要性和可行性，其中必要性是从企业的核心痛点需求出发，从企业的数据安全、业务保障及监管合规的角度说清楚企业开源安全方面存在的风险及其严重性。关于可行性主要是判断企业当前开展此项工作是否具备条件，并明确投入产出比。基于以上两点的分析，让公司管理层清晰的理解并认同应该立即开展此项工作。

## 1.2 需求及必要性分析
### 1.2.1 分析思路
首先，因为此项工作是企业安全治理工作，所以需求及必要性分析必须从公司管理者的视角来展开，必须是公司核心管理者最关注的公司运营层面的风险，并便于公司的核心管理者理解。基于此，建议从企业的数据安全、业务保障及监管合规保障三个角度展开需求的分析，因为通常这三个维度是企业管理者比较关注的。那么我们尝试以这三个维度的风险为目标，来拆解出开源软件安全威胁所带来的影响，并且将风险尽可能量化。

### 1.2.2 分析方法
分析方法的核心思路是由点及面，立体的呈现当前开源软件安全威胁在数据安全、业务保障、监管合规方面存在的风险。点是指公司面临的最严重的此类安全事件，重要是体现单个问题的严重性，面是指公司到底面临多少此类安全事件，重点体现的是严重性的规模。

关于点，首先需要找出企业历史上因为开源软件安全漏洞或许可合规风险导致的所有安全事件或潜在安全事件，然后对这些事件按照最终影响进行分类，把它们都归类到数据安全、业务保障、监管合规三个方面。最后，只需要挑出其中每一类中最严重的1～2个安全事件案例。如果某一类型在企业过去历史上没有出现过此类风险，那么我们可以从同行对标企业过去产生过的安全事件中找出1～2个典型的安全事件。这里的同行对标最好是公司管理层最喜欢对标的同行企业，这样才具备说服力。

关于面，需要对以上三类风险导致的原因进行剖析：
比如是企业软件开发过程中引入开源组件的漏洞导致的数据泄露事件？
比如是企业外部采购的商业软件中引入的开源组件漏洞导致的漏洞攻击，进而导致被勒索，影响业务连续性？
诸如此类，剖析导致这些典型事件的主要原因。
然后，基于以上的原因剖析，那么从规模的角度来统计，公司有多少自研的软件，用了多少开源组件，存在多少同类型可能导致数据泄露的安全漏洞？以此来从“面”的角度分析出事情的严重程度及其规模。

注意，以上从点到面的分析方法，需要分别从数据安全、业务保障、监管合规的角度分别展开一轮分析，最后总结成完整的调研报告。

### 1.2.3 预期结论
公司历史上发生了xx起安全事件，其中跟开源安全威胁相关的事件xx起，占比超过xx%；

其中导致数据安全相关的事件xx起，占比xx%，最严重的两起事件分别是xxx，导致xxx万用户数据的泄露风险，背后的原因主要是我们xx系统开发过程中用了xx开源组件，该开源组件存在高危漏洞被攻击。

其中导致业务连续性相关的事件xx起，占比xx%，最严重的两起事件分别是xxx，这两起事件导致xx核心业务停摆xx分钟，导致企业损失xx元。背后的原因主要是我们采购的xx系统用了xx开源组件，该开源组件存在高危漏洞被攻击。

其中导致企业面临监管合规风险的事件xx起，占比xx%，最典型的两起事件分别是xx，这两起事件导致公司收到xx监管部门的xx影响。背后的原因主要是我们xx系统开发过程中用了xx开源组件，该开源组件是GPL开源许可证，存在知识产权合规风险。

通过分析，引起这些事件的原因均是来自我们的业务系统使用了大量的开源组件，且这些开源组件存在严重的安全漏洞及开源许可证合规问题导致安全事件。通过我们对你企业使用的GitLab代码仓库摸底，发现我们仓库中的xxx个代码仓库中使用了xxx个开源组件，其中能导致此类安全事件的安全漏洞xxx个，严重的漏洞xxx个，而且每天会新引入xx个开源组件，带来xxx个漏洞威胁。其中xx重点业务受影响的漏洞xx个，xx重点业务系统受影响的漏洞xx个。

基于以上，企业多个核心业务系统当前面临非常严重的开源软件安全威胁，应该尽快开展治理工作。

附录13.2中含各行业开源安全相关事件参考。

## 1.3 方案及可行性分析
### 1.3.1 分析思路
通过需求及其必要性分析，公司管理层已经非常明确此项工作的价值及其必要性，接下来公司管理者最核心思考的问题是如何开展这项工作的治理，如果需要开展治理大概投入是如何的？以及该项工作治理的成功率如何？管理者必须考虑开展此项工作的性价比，以此来最终决定当下是否需要开展此项工作。

### 1.3.2 分析方法
关于方案及可行性的分析我们通常可以对行业进行调研，通过调研同行业的其他企业面临的风险和举措，起到查漏补缺和对照的作用，为后续方案选型做基础。

**行业调研关键要点**
- 选取至少3-5家同行业、规模和业务形态相近的企业进行调研；
- 同行业是否开展了这项工作、投入的资源情况、牵头负责部门是哪些；
- 同行业识别到了哪些软件供应链/开源组件安全风险，开展项目的动机，怎么解决的（采用方案、解决到了什么程度和周期情况）。

### 1.3.3 方案调研
**通过调研识别有哪些解决方案，调研的范围包括：**
- 业界有哪些解决方案，比如有哪些开源解决方案、商业产品、技术框架；
- 同行业的解决方案，比如A企业通过自研解决、B企业采购了某商业产品
- 企业内部有没有类似的解决方案，比如基础架构团队实现了软件资产的统一管理；
- 企业内部研发流程现状调研，包括当前CI/CD流程的成熟度，这对于选择什么样的方案也很关键。

**常见的调研维度包括：**
- 功能调研，该方案具备哪些功能，包括：支持的语言、软件形态、支持分析的风险类型、修复和集成能力等；
- 性能调研，方案的检测准确率、覆盖率、检测速度和系统配置要求等；
- 成本调研，包括实施成本、运营成本、采购成本、时间成本；
- 现状调研，包括企业CI/CD流程现状及都使用了什么工具，接入覆盖率及流程成熟度等，这对于选择什么样的产品方案和实施成本的预估会更准确；
- 同行使用情况，有哪些同行使用该方案。

行业调研报告参考：
附录13.2中含各行业完整的调研报告参考，可获取。

### 1.3.4 方案评估
将这些方案从功能、性能、成本和风险等方面来评估，根据可投入的资源情况，筛选得到初步可行（ROI较高）的方案。
### 1.3.4.1 评估表
逐个维度具体评估不同方案，形成如下的方案对比评估表：
<table border="1" cellpadding="5" cellspacing="0">
  <thead>
    <tr>
      <th rowspan="2">一级评估维度</th>
      <th rowspan="2">二级评估维度</th>
      <th rowspan="2">完全自研</th>
      <th rowspan="2">部分自研</th>
      <th rowspan="2">使用开源工具<br>dependency-check</th>
      <th rowspan="2">使用商业产品-A</th>
      <th rowspan="2">使用商业产品-B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td rowspan="10">功能评估</td>
      <td>语言及包管理工具支持度</td>
      <td>高（可根据需求定制）</td>
      <td>高</td>
      <td>低（只支持部分语言）</td>
      <td>高</td>
      <td>高</td>
    </tr>
    <tr>
      <td>文件类型支持度</td>
      <td>中（二进制支持难）</td>
      <td>中</td>
      <td>低（不支持二进制）</td>
      <td>中</td>
      <td>高</td>
    </tr>
    <tr>
      <td>漏洞优先级判断效果</td>
      <td>中</td>
      <td>中</td>
      <td>低（仅参考CVSS评分）</td>
      <td>中</td>
      <td>高（漏洞评级优化）</td>
    </tr>
    <tr>
      <td>漏洞可达性分析效果</td>
      <td>低</td>
      <td>低</td>
      <td>低</td>
      <td>中（支持覆盖度低）</td>
      <td>高（支持覆盖度高）</td>
    </tr>
    <tr>
      <td>漏洞修复能力效果</td>
      <td>中</td>
      <td>中</td>
      <td>低</td>
      <td>中</td>
      <td>高</td>
    </tr>
    <tr>
      <td>检测结果输出效果</td>
      <td>高</td>
      <td>中</td>
      <td>低</td>
      <td>中</td>
      <td>高</td>
    </tr>
    <tr>
      <td>系统集成能力</td>
      <td>高</td>
      <td>高</td>
      <td>低</td>
      <td>中</td>
      <td>高</td>
    </tr>
    <tr>
      <td>API完善度</td>
      <td>高（可根据需求定制）</td>
      <td>高</td>
      <td>低（不支持）</td>
      <td>中</td>
      <td>高</td>
    </tr>
    <tr>
      <td>CI/C支持度</td>
      <td>高（可根据需求定制）</td>
      <td>高</td>
      <td>低</td>
      <td>中</td>
      <td>高</td>
    </tr>
    <tr>
      <td>易用性</td>
      <td>中（依赖产品能力）</td>
      <td>中</td>
      <td>低</td>
      <td>中</td>
      <td>高</td>
    </tr>
    <tr>
      <td rowspan="5">性能评估</td>
      <td>检测效果（准确率、覆盖率）</td>
      <td>中</td>
      <td>中</td> 
      <td>低（改造存在不确定性）</td>
      <td>高</td> 
      <td>高</td> 
    </tr>
    <tr>
      <td>知识库更新时效</td>
      <td>低（跟进难度极大）</td>
      <td>中</td>
      <td>低（无保障）</td>
      <td>较高</td>
      <td>高</td>
    </tr>
    <tr>
      <td>稳定性</td>
      <td>高</td>
      <td>中</td>
      <td>低</td>
      <td>中</td>
      <td>高</td>
    </tr>
    <tr>
      <td>并发度（同时可检测任务数）</td>
      <td>高</td>
      <td>中</td>
      <td>低</td>
      <td>中</td>
      <td>高</td>
    </tr>
    <tr>
      <td>检测速度（单任务）</td>
      <td>高</td>
      <td>中</td>
      <td>低</td>
      <td>高</td>
      <td>高</td>
    </tr>
    <tr>
      <td rowspan="5">成本评估</td>
      <td>实施成本</td>
      <td>极高（需投入5-10人研发）</td>
      <td>中（投入1-2人研发）</td>
      <td>低（投入1人研发改造）</td>
      <td>低（无需研发投入）</td>
      <td>低（无需研发投入）</td>
    </tr>
    <tr>
      <td>使用成本</td>
      <td>低</td>
      <td>中</td>
      <td>高</td>
      <td>低</td>
      <td>低</td>
    </tr>
    <tr>
      <td>维护成本（知识数据维护和功能迭代）</td>
      <td>极高</td>
      <td>高</td>
      <td>高</td>
      <td>中</td>
      <td>低</td>
    </tr>
    <tr>
      <td>采购成本</td>
      <td>无</td>
      <td>中</td>
      <td>无</td>
      <td>低</td>
      <td>中</td>
    </tr>
    <tr>
      <td>时间成本</td>
      <td>高（半年以上研发周期）</td>
      <td>中（三个月研发周期）</td>
      <td>高（四个月研发改造）</td>
      <td>中（部分功能不具备）</td>
      <td>低</td>
    </tr>
    <tr>
      <td rowspan="1" colspan="2">风险</td> 
      <td>高（需要持续长期投入，技术门槛高）</td>
      <td>对三方工具核心能力存在依赖导致性能瓶颈</td>
      <td>开源工具无服务保障</td>
      <td>缺少本地化团队支持</td>
      <td>不支持定制</td>
    </tr>
    <tr>
      <td colspan="2">同行使用情况</td> 
      <td>A</td>
      <td>B</td>
      <td>C</td>
      <td>E</td>
      <td>D、F、G、H</td>
    </tr>
  </tbody>
</table>

### 1.3.4.2 评估结果初步汇报
基于以上评估表结果，向上级进行总结汇报，以此确定下一步工作方向，主要是确定自研还是结合商业方案：<br>
- 1）总结每个方案主要的成本投入和收益情况，根据关注的成本和风险，对方案进行综合排序；<br>
- 2）沟通汇报初步调研的方案结果，决策下一步需要POC测试验证的方案。

### 1.3.4.3 POC验证方案
在初步筛选了方案后，通常需要通过PoC（Proof of Concept）测试对方案的可行性、实际效果进行验证。

### 1.3.4.3.1 明确PoC测试方案
方案的确定需要考虑以下方面，因地制宜，避免一味追求检测结果数量的多少而忽略实际应用效果：
- 需求，从要解决的问题出发，判断方案的要解决的重点问题；
- 技术栈，根据内部主要使用的语言、开发工具，决定SCA工具需要支持的范围；
- 研发流水线，根据代码仓库、制品库、CICD等使用情况，决定SCA工具需要集成的范围；
- 业务形态，根据业务形态确定需要分析的软件形态，如源代码、固件等，决定SCA工具需要分析的范围；
- 现有安全能力，根据已有安全能力情况，考虑SCA工具可能需要具备的扩展性、联动能力。<br>
例如：
- 功能验证
- 由于部分检测对象无法提供源代码，SCA工具还需要能够对制品文件进行分析；
- 由于配置中依赖的第三方组件，在代码中可能没有调用，导致漏洞不能被利用，因此需要通过可达性分析判断漏洞在应用中的可利用性。
- 性能验证
- 由于SCA工具需要集成进流水线检测，需要考虑检测的速度和并发检测能力。

附录13.2中，提供了详细的行业企业POC测试方案及测试用例参考，可获取。

### 1.3.4.3.2 基于PoC测试方案进行验证，需要注意：
- 测试过程覆盖每一个测试项；
- 每项的测试用例应尽可能涵盖未来的所有使用场景；
- 选择具有区分度的测试样本作为用例；
- 准确率与覆盖率可参考SCA基准测试项目。

### 1.3.4.4 确定技术方案
根据方案初步评估情况和POC验证结果，根据预计可投入的资源情况，汇总得出当前最优的方案及其预期效果（即可解决哪些问题、解决的程度如何），此处注意不一定需要一下子解决所有问题，应该列出分阶段投入多少资源把这项问题解决到何种程度，因为本身也没有绝对的安全。站在企业的管理层角度关注的是投入产出比，同时将安全风险控制在一个可接受的范围。

### 1.3.5 预期结论
**同行调研结果：**
- 同行业同规模的xx、xx、xx等几家公司均已开展开源安全治理工作，xx、xx等几家公司今年正在开展开源安全治理工作；
- 同行业均是有xx部门牵头，xx、xx部门配合开展此项工作；
- xx公司（与我们公司最相似的公司）治理到xx程度了，投入了xx人力，使用的是xx商业产品，投入预算xx万/年；目前取得的效果是xxx（描述一下做到什么程度了，什么时候开始建设的）；
- 附行业调研报告。

**我公司建设方案：**
- 基于同行业分析，结合我们公司的风险现状和基础设施现状，建议采用成熟商业产品工具作为底层平台，将商业工具与公司研发流水线对接、结合安全运营平台落地；
- 预计需投入预算xx万，人力xx个，需要协调xx部门配合xx工作；
- 预计一年内达成xx目标，2-3年内达成xx目标；
- 附技术方案调研报告及商业产品对比报告。
